\subsection{Inverse Problem} 
\label{sec:inverse}

Before we attempt to solve the inverse problem of parameter estimation, 
we first check the ability of \geoclaw to simulate water surface elevation
realistically. To this end, we present a comparison between the 
(DART) buoy observations and their \geoclaw model counterparts
for a reference simulation in which the the Manning's $n$ coefficients were set to their default values $n_1=n_2=n_3=0.025$. Figure~\ref{fig:scatter} 
shows a scatter plot that compares the observed 
water surface elevation at the different gauge locations and the \geoclaw model counterparts. The plots show a reasonable agreement between the simulation and the observations available.  The differences between the simulation and observations can be attributed to uncertainty in the Manning's $n$ coefficients, errors in the earthquake rupture model, and insufficiently accurate bathymetry in the near-shore region.  The high amount of scatter from gauge 21418 can probably be attributed to its proximity to the epicenter of the earthquake and shore region.

Bayesian inference is now used to estimate the Manning's 
$n$ coefficient's ranges that minimize this scatter between 
observed and modeled water surface elevations and to estimate the variance of the noise in the measured data.
To this end, an adaptive MCMC method is used to sample 
the posterior distributions \citep{Gareth2009,Haario2001} and consequently 
update the Manning's $n$ coefficients distributions in light of the 
observed data. This sampling requires tens of thousands of 
\geoclaw model runs that are prohibitively expensive as each MCMC 
sample requires an independent \geoclaw realization. Instead,
the surrogate model created using PC expansions provides a computationally
efficient alternative that requires only evaluating the PC expansion
for different values of the canonical vector of random variables $\xxi$.

The MCMC algorithm required $50,000$ iterations to guarantee convergence
and to obtain the posteriors of the Manning's $n$ coefficients: 
$n_1$, $n_2$ and $n_3$ as well as for the variance $\sigma^2$. Figure \ref{fig:mcmc} 
shows the sample chains for the input parameters for different iterations of the MCMC algorithms. 
The different panels show well-mixed chains for all input parameters as well as the variance $\sigma^2$.
The chain of  $n_{1}$ spans the entire range of the prior, meaning that the observations are not informative 
concerning this input.  In contrast, the $n_{2}$ chain appears to be concentrated in the 
lower end of the parameter range, with values between 0.005 and 0.1. 
For $n_{3}$, the chain appears to be concentrated in the 
upper end of the parameter range. Finally, the chain for the variance 
appears to be well mixed with a well defined posterior range between 0.02 and 0.022.  \comment{Add discussion}

Next, the computed MCMC chains are used to determine the posterior 
distributions using kernel density estimation (KDE)
~\citep{Parzen1962,Silverman1986}.  The resulting posterior pdfs 
of the three Manning's $n$ coefficients $n_1,n_2,n_3$ are shown 
in Figure~\ref{fig:pdfs} in addition to the pdfs of $\sigma^2$. 
Note that the first 10000 iterates, associated with the burn-in period, were discarded.  
As expected from the chains shown in Figure~\ref{fig:mcmc}, the posterior pdfs of $n_1$ appear to be fairly flat, 
and similar to the uniform prior; an indication that 
the observed data were not useful to refine our prior knowledge for $n_1$.,
In contrast, the posterior pdf of $n_2$ exhibits well-defined peak, 
with a Maximum A Posteriori (MAP) estimate of around 0.011
and an extended tail towards the larger Manning's $n$ coefficient values.
For $n_3$, we observe a posterior that has a well defined peak
of 0.18 but no clear pdf shape. The posterior distribution of the variance 
appears to be well-defined of Gaussian-like shape. 
The MAP value of $\sigma^2=0.021$ can be used to estimate the water surface elevation standard 
deviation estimated to be 0.145~$m$. This value is a reflection of the mismatch between the model and 
observed data. \comment{marginal "", correlation ''', joint}.

With the MCMC chains computed, we can now con- struct the joint posterior distributions of the parameters
using KDE. Since the posterior of m is close to the prior, we show in Fig. 17 the joint posterior distribu- tions of a and Vmax (left panel), and of a and a2 on 17–18 September (right panel). These pdfs clearly show a single peak located at a 5 1.026 and Vmax 5 34 m s21, and that can be identified with the MAP estimates from the marginalized pdfs. The right panel also clearly shows a tight estimate for a with little spread around it. Setting m 5 0 (default HYCOM value), and substituting the MAP estimates for Vmax and a in Eq. (5), we obtain the ‘‘optimal’’ (most likely) curve describing the drag co- efficient CD’s dependence on wind speed; this curve is shown in Fig. 18. In addition to decreasing the variance between simulations and observations, the impact of the MAP values on temperature can be assessed with the help of the surrogate. The results for the area-averaged SST and mixed layer depth (other quantities of interest can be treated similarly) are displayed in Fig. 19. The default drag parameters underestimate the cooling by 0.58C and the mixed layer depth by as much as 15 m; note that the mixed layer depth feels the impact of the in- creased drag from 18 to 20 September, otherwise, the two curves overlap.
%   0.180222380841571   0.011347632046398   0.185486684362890   0.021050903421753



