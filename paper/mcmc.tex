\subsection{Inverse Problem} 
\label{sec:inverse}

Before we attempt to solve the inverse problem of parameter estimation, 
we first check the ability of \geoclaw to simulate water surface elevation
realistically. To this end, we present a comparison between the 
(DART) buoy observations and their \geoclaw model counterparts
for a reference simulation in which the the Manning's $n$ coefficients were set to their default values $n_1=n_2=n_3=0.025$. Figure~\ref{fig:scatter} 
shows a scatter plot that compares the observed 
water surface elevation at the different gauge locations and the \geoclaw model counterparts. The plots show a reasonable agreement between the simulation and the observations available.  The differences between the simulation and observations can be attributed to uncertainty in the Manning's $n$ coefficients, errors in the earthquake rupture model, and insufficiently accurate bathymetry in the near-shore region.  The high amount of scatter from gauge 21418 can probably be attributed to its proximity to the epicenter of the earthquake and shore region.

Bayesian inference is now used to estimate the Manning's 
$n$ coefficient's ranges that minimize this scatter between 
observed and modeled water surface elevations and to estimate the variance of the noise in the measured data.
To this end, an adaptive MCMC method is used to sample 
the posterior distributions \citep{Gareth2009,Haario2001} and consequently 
update the Manning's $n$ coefficients distributions in light of the 
observed data. This sampling requires tens of thousands of 
\geoclaw model runs that are prohibitively expensive as each MCMC 
sample requires an independent \geoclaw realization. Instead,
the surrogate model created using PC expansions provides a computationally
efficient alternative that requires only evaluating the PC expansion
for different values of the canonical vector of random variables $\xxi$.

The MCMC algorithm required $50,000$ iterations to guarantee convergence and to
obtain the posteriors of the Manning's $n$ coefficients:  $n_1$, $n_2$ and $n_3$
as well as for the variance $\sigma^2$. Figure \ref{fig:mcmc}  shows the sample
chains for the input parameters for different iterations of the MCMC algorithms.
The different panels show well-mixed chains for all input parameters as well as
the variance $\sigma^2$. The chain of  $n_{1}$ spans the entire range of the
prior, meaning that the observations are not informative  concerning this input.
In contrast, the $n_{2}$ chain appears to be concentrated in the  lower end of
the parameter range, with values between 0.005 and 0.1.  For $n_{3}$, the chain
appears to be concentrated in the  upper end of the parameter range. Finally,
the chain for the variance  appears to be well mixed with a well defined
posterior range between 0.02 and 0.022.  These values align well with what is
commonly considered physically relevant for near-shore and deep-water regions.

Next, the computed MCMC chains are used to determine the marginalized posterior 
distributions using kernel density estimation (KDE)~\citep{Parzen1962,Silverman1986}.  
The resulting marginalized posterior pdfs of the three Manning's $n$ coefficients 
$n_1,n_2,n_3$ are shown in Figure~\ref{fig:pdfs} in addition to the pdfs of $\sigma^2$. 
Note that the first 10000 iterates, associated with the burn-in period, were discarded.  
As expected from the chains shown in Figure~\ref{fig:mcmc}, the marginalized posterior 
pdfs of $n_1$ appear to be fairly flat, and similar to the uniform prior; an indication 
that the observed data were not useful to refine our prior knowledge for $n_1$. In 
contrast, the posterior pdf of $n_2$ exhibits a well-defined peak, with a Maximum A 
Posteriori (MAP) estimate of around 0.011 and an extended tail towards the larger 
Manning's $n$ coefficient values. For $n_3$, we observe a posterior that has a well 
defined peak of 0.18 but no clear pdf shape. The posterior distribution of the variance 
appears to be well-defined of Gaussian-like shape. The MAP value of $\sigma^2=0.021$ 
can be used to estimate the water surface elevation standard deviation estimated to 
be 0.145~$m$. This value is a reflection of the mismatch between the model and 
observed data.

We finally investigate the existence of any correlation arising between the inferred parameters.
This study is motivated by the fact that the Manning's $n$ coefficients have an important role 
in characterizing the tsunami model predictions. Moreover, it is instructive to analyze the 
correlation between the various $n$ parameters to gain some insight into their mutual dependence.
To this end, we compute the two-dimensional marginalized joint posteriors for each 
possible combination of the parameters $n_1$, $n_2$ and $n_3$, namely $p(n_1, n_2), p(n_1, n_3)$ and $p(n_2, n_3)$. 
Figure~\ref{fig:joint}(left) shows the scatter plots of the MCMC samples of the combinations of 
inferred parameters obtained from the chain samples of the marginalized posterior excluding 
the burn-in iterations. The plots reveal no clear correlation in all three cases. 
These samples can be readily exploited to reconstruct the joint density for each combination of parameters. 
The right column of Figure~\ref{fig:joint} shows the contour plots of the marginalized joint posteriors 
$p(n_1, n_2)$, $p(n_1, n_3)$ and $p(n_2, n_3)$. The contours are obtained from the
distribution reconstructed via KDE and shown for the cases corresponding to greater than $10\%$
of the maximum probability.

To quantify the degree of no-correlation between each possible pair of parameters, we compute 
the corresponding correlation coefficient which is a unitless scalar that falls in the range 
$(-1, 1)$, with $1$ indicating a perfect positive correlation, $âˆ’1$ a perfect negative correlation and $0$ for
a no-correlation case.
% $R(n_2, n_3)$, $R(n_2, \sigma^2)$, and $R(n_3, \sigma^2)$.
The correlation coefficient, $R(X, Y )$, between two random variables $X$ and $Y$ is defined as:

\begin{equation}
R(X,Y) = \frac{E[(X - \mu_X)(Y - \mu_Y )]}{\sigma_X \sigma_Y} 
\end{equation}
where $\sigma_X$ and  $\sigma_Y$ are the standard deviations of  $X$ and $Y$, $\mu_X$
and $\mu_Y$  are the means of  $X$ and $Y$ respectively;
and $E$ is the expectation operator.  In our case, the correlation coefficient
was less than $0.06$ for all possible combinations of parameters; again indicating no correlation
existing between the inferred parameters.



%   0.180222380841571   0.011347632046398   0.185486684362890   0.021050903421753



